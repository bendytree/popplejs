(function(o,p,e){"use strict";var a=o(p),n=o(e),l=null;o(function(){var p=o("body");0===p.length&&o.error("Do not use popple until the DOM has loaded."),l=o("<div></div>").hide().appendTo(p).click(function(p){p.preventDefault();for(var e=o.popple.modals.length-1;e>=0;e--){var a=o.popple.modals[e],n=a.modal("options");n.bgClose&&a.modal("hide")}});var e=function(){var o="popple-bounce-push-animation",p="popple-bounce-pop-animation",e="popple-sleep-animation",a="-webkit-animation-name",n="popple-wake-animation",l="animation-fill-mode",t="-moz-animation-name",i="-webkit-transform",s="-webkit-keyframes",d="-o-animation-name",r="-moz-keyframes",m="-moz-transform",u="animation-name",f="popple-bounce",c="popple-bg-out",h="popple-bg-in",g="-o-keyframes",x="-o-transform",v="translateY",A="keyframes",b="transform",k="popple-bg",w="position",C="forwards",y="opacity",z="-300px";return["@",A," ",o,"{0%{",b,":",v,"(",z,");",y,":0}60%{",b,":",v,"(20px)}100%{",b,":",v,"(0);",y,":1}}@",s," ",o,"{0%{",i,":",v,"(",z,");",y,":0}60%{",i,":",v,"(20px)}100%{",i,":",v,"(0);",y,":1}}@",r," ",o,"{0%{",m,":",v,"(",z,");",y,":0}60%{",m,":",v,"(20px)}100%{",m,":",v,"(0);",y,":1}}@",g," ",o,"{0%{",x,":",v,"(",z,");",y,":0}60%{",x,":",v,"(20px)}100%{",x,":",v,"(0);",y,":1}}.",f,".push{",u,":",o,";",a,":",o,";",t,":",o,";",d,":",o,"}@",A," ",p,"{0%{",b,":",v,"(0);",y,":1}40%{",b,":",v,"(20px)}100%{",b,":",v,"(",z,");",y,":0}}@",s," ",p,"{0%{",i,":",v,"(0);",y,":1}40%{",i,":",v,"(20px)}100%{",i,":",v,"(",z,");",y,":0}}@",r," ",p,"{0%{",m,":",v,"(0);",y,":1}40%{",m,":",v,"(20px)}100%{",m,":",v,"(",z,");",y,":0}}@",g," ",p,"{0%{",x,":",v,"(0);",y,":1}40%{",x,":",v,"(20px)}100%{",x,":",v,"(",z,");",y,":0}}.",f,".pop{",u,":",p,";",a,":",p,";",t,":",p,";",d,":",p,"}@",A," ",n,"{0%{",b,":",v,"(100px);",y,":0}100%{",b,":",v,"(0);",y,":1}}@",s," ",n,"{0%{",i,":",v,"(100px);",y,":0}100%{",i,":",v,"(0);",y,":1}}@",r," ",n,"{0%{",m,":",v,"(100px);",y,":0}100%{",m,":",v,"(0);",y,":1}}@",g," ",n,"{0%{",x,":",v,"(100px);",y,":0}100%{",x,":",v,"(0);",y,":1}}.popple-modal.wake{",u,":",n,";",a,":",n,";",t,":",n,";",d,":",n,"}@",A," ",e,"{0%{",b,":",v,"(0);",y,":1}100%{",b,":",v,"(100px);",y,":0}}@",s," ",e,"{0%{",i,":",v,"(0);",y,":1}100%{",i,":",v,"(100px);",y,":0}}@",r," ",e,"{0%{",m,":",v,"(0);",y,":1}100%{",m,":",v,"(100px);",y,":0}}@",g," ",e,"{0%{",x,":",v,"(0);",y,":1}100%{",x,":",v,"(100px);",y,":0}}.popple-modal.sleep{",u,":",e,";",a,":",e,";",t,":",e,";",d,":",e,"}@",A," ",h,"{0%{",y,":0}100%{",y,":1}}@",s," ",h,"{0%{",y,":0}100%{",y,":1}}@",r," ",h,"{0%{",y,":0}100%{",y,":1}}@",g," ",h,"{0%{",y,":0}100%{",y,":1}}.",k,".in{",u,":",h,";",a,":",h,";",t,":",h,";",d,":",h,"}@",A," ",c,"{0%{",y,":1}100%{",y,":0}}@",s," ",c,"{0%{",y,":1}100%{",y,":0}}@",r," ",c,"{0%{",y,":1}100%{",y,":0}}@",g," ",c,"{0%{",y,":1}100%{",y,":0}}.",k,".out{",u,":",c,";",a,":",c,";",t,":",c,";",d,":",c,"}.",k,"-diagonal{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAIUlEQVQIW2NkQAL///83ZoTxwRxGxrNgARgHxGZE5oAEAOz3DzVasxQ9AAAAAElFTkSuQmCC)}.",k,"{background-color:rgba(0,0,0,.92);width:100%;height:100%;",w,":fixed;top:0;left:0;z-index:1000;",l,":",C,";-webkit-",l,":",C,";-moz-",l,":",C,";-o-",l,":",C,"}.popple-modal{background-color:#fff;",w,":relative;top:100px;border-radius:3px;padding:20px;",w,":fixed;z-index:1001;display:none;box-shadow:0 0 15px rgba(0,0,0,.3);overflow:hidden;",l,":",C,";-webkit-",l,":",C,";-moz-",l,":",C,";-o-",l,":",C,"}.popple-closer-x{",w,':absolute;top:7px;right:14px;color:#000;font-size:19px;line-height:19px;cursor:pointer;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;',y,":.18;text-shadow:0 1px 0 #fff;font-weight:bold}.popple-closer-x:hover{",y,":.12}"].join("")}();7===e.length?o("head").append('<link href="popple.css" rel="stylesheet" type="text/css" />'):o("head").append(['<style type="text/css">',e,"</style>"].join(""))}),o.popple={defaults:{bg:"popple-bg popple-bg-diagonal",push:!0,duration:400,animation:"popple-bounce",closer:!0,bgClose:!0,escClose:!0},modals:[],active:function(){return o.popple.modals.length?o.popple.modals[o.popple.modals.length-1]:null},push:function(p,e){var a=null;return p.each(function(){var p=o(this),n=p.data("modal");if(n||p.data("modal",n=new i(p,e)),"push"===e)n.push();else if("pop"===e)n.pop();else{if("options"===e)return a=n.options,void 0;n.options.push&&n.push()}}),a||p},pop:function(){0!==o.popple.modals.length&&o.popple.modals[o.popple.modals.length-1].data("modal").pop()},popAll:function(){for(var p=o.popple.modals.length-1;p>=0;p--)o.popple.modals[p].data("modal").pop()}};var t=a.width();(function(){var p=null;a.on("resize",function(){p||(p=setTimeout(function(){p=!1,t=a.width();for(var e=0;o.popple.modals.length>e;e++){var n=o.popple.modals[e];n.data("modal").center()}},50))})})();var i=function(p,e){var a=o(p),n=this;n.options=o.extend({},o.popple.defaults,"object"==typeof e&&e),a.addClass("popple-modal").on("click",".popple-pop",function(){n.pop()}).on("click",".popple-pop-all",o.popple.popAll),n.options.closer&&a.append("<div class='popple-pop popple-closer-x'>x</div>"),n.center=function(){a.css("left",Math.floor((t-a.width())/2)+"px")},n.push=function(){a.trigger("push"),o.popple.modals.push(a),n.center(),l.removeClass().addClass(n.options.bg);var p=n.options.animation?n.options.duration:0;if(a.add(l).css({"animation-duration":p+"ms","-webkit-animation-duration":p+"ms","-moz-animation-duration":p+"ms","-o-animation-duration":p+"ms","-MS-animation-duration":p+"ms"}),"string"==typeof n.lastAnimation&&n.lastAnimation.length>0&&(a.removeClass(n.lastAnimation),delete n.lastAnimation),"string"==typeof n.options.animation&&n.options.animation.length>0&&a.addClass(n.options.animation),n.options.animation===!0&&a.addClass(o.popple.defaults.animation),l.show().removeClass("out").addClass("in"),a.removeClass("push pop wake sleep").show().addClass("push"),p?setTimeout(function(){a.trigger("pushed")},p):a.trigger("pushed"),o.popple.modals.length>1){var e=o.popple.modals[o.popple.modals.length-2];e.removeClass("push pop wake sleep").addClass("sleep")}},n.pop=function(){var p=o.inArray(a,o.popple.modals);if(-1!==p){a.trigger("pop"),o.popple.modals.splice(p,1),a.removeClass("push pop wake sleep").addClass("pop");var e=n.options.animation?n.options.duration:0;if(o.popple.modals.length>0){var t=o.popple.modals[o.popple.modals.length-1];t.removeClass("push pop wake sleep").addClass("wake")}else l.removeClass("in out").addClass("out"),setTimeout(function(){l.hide()},e);setTimeout(function(){a.hide().trigger("popped")},e)}}},s=o.fn.modal;o.fn.modal=function(p){return o.popple.push(this,p)},o.fn.modal.noConflict=function(){return o.fn.modal=s,o.fn.modal},n.keyup(function(p){if(27===p.keyCode){var e=o.popple.active();e&&e.modal("options").escClose&&e.modal("pop")}}),n.on("click","[popple]",function(p){p.preventDefault();var e=o(this),a=o.trim(e.attr("popple")),n=o(a);n.modal(),n.one("pop",function(){e.focus()})})})(jQuery,window,document);